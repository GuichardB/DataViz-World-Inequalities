---
title: "Visualisations Baptiste"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Import des library

```{r message = FALSE}
library(tidyverse)
library(ggplot2)
library(dplyr)
library(reshape2)
```

## Import des données

```{r message = FALSE}
world_region_data <- read_delim("data/World_Region_Data/world_region_data.csv", 
    ";", escape_double = FALSE, trim_ws = TRUE)
```
```{r message = FALSE}
world_region_data2 <- read_delim("data/World_Region_Data/world_region_data2.csv", 
    ";", escape_double = FALSE, trim_ws = TRUE)
```

## Agrégation des 2 datasets

```{r}
merged <- merge(x = world_region_data, y = world_region_data2, by = "Year", all = TRUE)
dataset <- data.frame(merged)
dataset <- tibble(dataset)
```

## Création de sous-datasets pour séparer les données par indicateurs

```{r}
NIdataset <- dataset %>% select("Year", ends_with("NI"))
GDPdataset <- dataset %>% select("Year", ends_with("GDP"))
PTNIB40dataset <- dataset %>% select("Year", ends_with("PTNIB40"))
PTNIB50dataset <- dataset %>% select("Year", ends_with("PTNIB50"))
PTNIT1dataset <- dataset %>% select("Year", ends_with("PTNIT1"))
PTNIT10dataset <- dataset %>% select("Year", ends_with("PTNIT10"))
PTNIM40dataset <- dataset %>% select("Year", ends_with("PTNIM40"))
```

## Visualisation rapide des données
```{r}
head(NIdataset)

```

## Tests de graphiques généraux

```{r}
# Part des Top 10% de la population dans le revenu national 
PTNIT10dataset %>% filter(Year == "2019") %>% melt(id.vars="Year") %>% filter(variable=="WesternEuropePTNIT10"|variable=="AsiaPTNIT10"|variable=="EasternEuropePTNIT10"|variable=="NorthernAmericaPTNIT10"|variable=="OceaniaPTNIT10"|variable=="LatinAmericaPTNIT10"|variable=="AfricaPTNIT10") %>%
ggplot(aes(x=variable, y=value, fill=variable)) + geom_bar(stat="identity") + xlab("Régions du monde") + ylab("Part du revenu national des 10% les plus riches")


#Evolution de la part du revenu national des 10% les plus riches, de 1980 à 2019
PTNIT10dataset %>% melt(id.vars="Year") %>% filter(variable=="WesternEuropePTNIT10") %>%
ggplot(aes(x=Year, y=value, colour=variable)) + geom_line()
```